{% extends 'base.html' %} 
{% load static %} 
{% block content %}
<div class="page-inner">
  <h4 class="page-title">FireApp Dashboard</h4>
  <div class="page-category">Simple yet flexible JavaScript charting for designers & developers. Please checkout their <a href="https://www.chartjs.org/" target="_blank">full documentation</a>.</div>
  <div class="row">
    <div class="col-md-6">
      <div class="card">
        <div class="card-header">
          <div class="card-title">Line Chart</div>
        </div>
        <div class="card-body">
          <div class="chart-container">
            <canvas id="lineChart"></canvas>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <div class="card">
        <div class="card-header">
          <div class="card-title">Bar Chart</div>
        </div>
        <div class="card-body">
          <div class="chart-container">
            <canvas id="barChart"></canvas>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <div class="card">
        <div class="card-header">
          <div class="card-title">Pie Chart</div>
        </div>
        <div class="card-body">
          <div class="chart-container">
            <canvas id="pieChart" style="width: 50%; height: 50%"></canvas>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <div class="card">
        <div class="card-header">
          <div class="card-title">Doughnut Chart</div>
        </div>
        <div class="card-body">
          <div class="chart-container">
            <canvas id="doughnutChart" style="width: 50%; height: 50%"></canvas>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <div class="card">
        <div class="card-header">
          <div class="card-title">Radar Chart</div>
        </div>
        <div class="card-body">
          <div class="chart-container">
            <canvas id="radarChart"></canvas>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <div class="card">
        <div class="card-header">
          <div class="card-title">Bubble Chart</div>
        </div>
        <div class="card-body">
          <div class="chart-container">
            <canvas id="bubbleChart"></canvas>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <div class="card">
        <div class="card-header">
          <div class="card-title">Multiple Line Chart</div>
        </div>
        <div class="card-body">
          <div class="chart-container">
            <canvas id="multipleLineChart"></canvas>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <div class="card">
        <div class="card-header">
          <div class="card-title">Multiple Bar Chart</div>
        </div>
        <div class="card-body">
          <div class="chart-container">
            <canvas id="multipleBarChart"></canvas>
          </div>
        </div>
      </div>
    </div>
      </div>
    </div>
  </div>
</div>
{% endblock %} 
{% block chart %}
<script>
  function loadChartData() {
    // pieChart
    fetch("/chart/")
      .then((response) => response.json())
      .then((data) => {
        var severityLevels = Object.keys(data);
        var counts = Object.values(data);
        var pieChart = document.getElementById("pieChart").getContext("2d");

        new Chart(pieChart, {
          type: "pie",
          data: {
            datasets: [
              {
                data: counts,
                backgroundColor: ["#1d7af3", "#f3545d", "#fdaf4b", "#fdff4b", "#a4e310", "#11c258"],
                borderWidth: 0,
              },
            ],
            labels: severityLevels,
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            legend: {
              position: "bottom",
              labels: {
                fontColor: "rgb(154, 154, 154)",
                fontSize: 11,
                usePointStyle: true,
                padding: 20,
              },
            },
            pieceLabel: {
              render: "percentage",
              fontColor: "white",
              fontSize: 14,
            },
            tooltips: false,
            layout: {
              padding: {
                left: 20,
                right: 20,
                top: 20,
                bottom: 20,
              },
            },
          },
        });
      })
      .catch((error) => console.error("Error:", error));

    // lineChart
    fetch("/lineChart/")
      .then((response) => response.json())
      .then((result_with_month_names) => {
        var months = Object.keys(result_with_month_names);
        var counts = Object.values(result_with_month_names);
        var lineChart = document.getElementById("lineChart").getContext("2d");

        new Chart(lineChart, {
          type: "line",
          data: {
            labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
            datasets: [
              {
                label: "Incidents per month",
                borderColor: "#1d7af3",
                pointBorderColor: "#FFF",
                pointBackgroundColor: "#1d7af3",
                pointBorderWidth: 2,
                pointHoverRadius: 4,
                pointHoverBorderWidth: 1,
                pointRadius: 4,
                backgroundColor: "transparent",
                fill: true,
                borderWidth: 2,
                data: counts,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            legend: {
              position: "bottom",
              labels: {
                padding: 10,
                fontColor: "#1d7af3",
              },
            },
            tooltips: {
              bodySpacing: 4,
              mode: "nearest",
              intersect: 0,
              position: "nearest",
              xPadding: 10,
              yPadding: 10,
              caretPadding: 10,
            },
            layout: {
              padding: { left: 15, right: 15, top: 15, bottom: 15 },
            },
          },
        });
      })
      .catch((error) => console.error("Error:", error));

    // multiLineChart
    fetch("/multilineChart/")
      .then((response) => response.json())
      .then((result_with_month_names) => {
        var countries = Object.keys(result_with_month_names);
        // Extract incident counts for each country
        var incidentCounts = [];
        var incidentCounts2 = [];
        var incidentCounts3 = [];

        // Sort function to sort object keys by month
        function sortObjectKeys(obj) {
          return Object.keys(obj).sort((a, b) => parseInt(a) - parseInt(b));
        }

        // Check if data for each country exists and extract incident counts
        if (countries.length >= 1) {
          var country1_data = result_with_month_names[countries[0]];
          var sortedKeys1 = sortObjectKeys(country1_data);
          incidentCounts = sortedKeys1.map((key) => country1_data[key]);
        }
        if (countries.length >= 2) {
          var country2_data = result_with_month_names[countries[1]];
          var sortedKeys2 = sortObjectKeys(country2_data);
          incidentCounts2 = sortedKeys2.map((key) => country2_data[key]);
        }
        if (countries.length >= 3) {
          var country3_data = result_with_month_names[countries[2]];
          var sortedKeys3 = sortObjectKeys(country3_data);
          incidentCounts3 = sortedKeys3.map((key) => country3_data[key]);

          var myDoughnutChart = new Chart(doughnutChart, {
            type: "doughnut",
            data: {
              datasets: [
                {
                  data: [10, 20, 30],
                  backgroundColor: ["#f3545d", "#fdaf4b", "#1d7af3"],
                },
              ],
        
              labels: ["Red", "Yellow", "Blue"],
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              legend: {
                position: "bottom",
              },
              layout: {
                padding: {
                  left: 20,
                  right: 20,
                  top: 20,
                  bottom: 20,
                },
              },
            },
          }); 
          
          

          var myRadarChart = new Chart(radarChart, {
            type: "radar",
            data: {
              labels: ["Running", "Swimming", "Eating", "Cycling", "Jumping"],
              datasets: [
                {
                  data: [20, 10, 30, 2, 30],
                  borderColor: "#1d7af3",
                  backgroundColor: "rgba(29, 122, 243, 0.25)",
                  pointBackgroundColor: "#1d7af3",
                  pointHoverRadius: 4,
                  pointRadius: 3,
                  label: "Team 1",
                },
                {
                  data: [10, 20, 15, 30, 22],
                  borderColor: "#716aca",
                  backgroundColor: "rgba(113, 106, 202, 0.25)",
                  pointBackgroundColor: "#716aca",
                  pointHoverRadius: 4,
                  pointRadius: 3,
                  label: "Team 2",
                },
              ],
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              legend: {
                position: "bottom",
              },
            },
          });
        
          var myBubbleChart = new Chart(bubbleChart, {
            type: "bubble",
            data: {
              datasets: [
                {
                  label: "Car",
                  data: [
                    { x: 25, y: 17, r: 25 },
                    { x: 30, y: 25, r: 28 },
                    { x: 35, y: 30, r: 8 },
                  ],
                  backgroundColor: "#716aca",
                },
                {
                  label: "Motorcycles",
                  data: [
                    { x: 10, y: 17, r: 20 },
                    { x: 30, y: 10, r: 7 },
                    { x: 35, y: 20, r: 10 },
                  ],
                  backgroundColor: "#1d7af3",
                },
              ],
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              legend: {
                position: "bottom",
              },
              scales: {
                yAxes: [
                  {
                    ticks: {
                      beginAtZero: true,
                    },
                  },
                ],
                xAxes: [
                  {
                    ticks: {
                      beginAtZero: true,
                    },
                  },
                ],
              },
            },
          });
        
        }

        

  window.addEventListener("load", loadChartData);


</script>
{% endblock %}
